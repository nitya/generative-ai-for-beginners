
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Multi-part curriculum teaching Generative AI from concepts to code">
      
      
        <meta name="author" content="AI Advocacy">
      
      
        <link rel="canonical" href="https://nitya.github.io/generative-ai-for-beginners/19-slm/">
      
      
        <link rel="prev" href="../18-fine-tuning/">
      
      
        <link rel="next" href="../20-mistral/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.45">
    
    
      
        <title>19. Small Language Models - Generative AI For Beginners</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-small-language-models-for-generative-ai-for-beginners" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Generative AI For Beginners" class="md-header__button md-logo" aria-label="Generative AI For Beginners" data-md-component="logo">
      
  <img src="../img/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Generative AI For Beginners
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              19. Small Language Models
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 2c-1.82 0-3.53.5-5 1.35C8 5.08 10 8.3 10 12s-2 6.92-5 8.65C6.47 21.5 8.18 22 10 22a10 10 0 0 0 10-10A10 10 0 0 0 10 2"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="cyan"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/generative-ai-for-beginners" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/generative-ai-for-beginners
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../00-course-setup/" class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../01-introduction-to-genai/" class="md-tabs__link">
          
  
  Lessons

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Generative AI For Beginners" class="md-nav__button md-logo" aria-label="Generative AI For Beginners" data-md-component="logo">
      
  <img src="../img/logo.svg" alt="logo">

    </a>
    Generative AI For Beginners
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/generative-ai-for-beginners" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/generative-ai-for-beginners
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-course-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-course-setup/SETUP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Lessons
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Lessons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-introduction-to-genai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-exploring-and-comparing-different-llms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Compare LLMs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-using-generative-ai-responsibly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Responsible AI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-prompt-engineering-fundamentals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Prompt Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-advanced-prompts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Advanced Prompts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-text-generation-apps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Text Generation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-building-chat-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Chat Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-building-search-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8. Search Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-building-image-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9. Image Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-building-low-code-ai-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. Low Code Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Integrating with11-integrating-with-function-calling/README.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11. Function Calling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-designing-ux-for-ai-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. Designing UX for AI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13-securing-ai-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    13. Securing AI Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14-the-generative-ai-application-lifecycle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    14. Generative AI App Lifecycle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15-rag-and-vector-databases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    15. RAG and Vector Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16-open-source-models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    16. Open Source Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17-ai-agents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    17. AI Agents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18-fine-tuning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    18. Fine Tuning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    19. Small Language Models
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    19. Small Language Models
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-small-language-models" class="md-nav__link">
    <span class="md-ellipsis">
      What Are Small Language Models?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-small-language-models-work" class="md-nav__link">
    <span class="md-ellipsis">
      How Do Small Language Models Work?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-distinctions-between-large-language-models-llms-and-small-language-models-slms" class="md-nav__link">
    <span class="md-ellipsis">
      The Distinctions between Large Language Models (LLMs) and Small Language Models (SLMs)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#applications-of-small-language-models" class="md-nav__link">
    <span class="md-ellipsis">
      Applications of Small Language Models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduce-phi-3-phi-35-family" class="md-nav__link">
    <span class="md-ellipsis">
      Introduce Phi-3 / Phi-3.5 Family
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduce Phi-3 / Phi-3.5 Family">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phi-3-35-instruct" class="md-nav__link">
    <span class="md-ellipsis">
      Phi-3 / 3.5 Instruct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phi-3-35-vision" class="md-nav__link">
    <span class="md-ellipsis">
      Phi-3 / 3.5 Vision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phi-35-moe" class="md-nav__link">
    <span class="md-ellipsis">
      Phi-3.5-MoE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-phi-335-family-models" class="md-nav__link">
    <span class="md-ellipsis">
      How to use Phi-3/3.5 Family models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to use Phi-3/3.5 Family models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inference-difference-clouds-api" class="md-nav__link">
    <span class="md-ellipsis">
      Inference difference Cloud's API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inference-phi-335-in-local-env" class="md-nav__link">
    <span class="md-ellipsis">
      Inference Phi-3/3.5 in local env
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-onnx-runtime" class="md-nav__link">
    <span class="md-ellipsis">
      What is ONNX Runtime?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-generative-ai" class="md-nav__link">
    <span class="md-ellipsis">
      What is Generative AI?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onnx-runtime-for-genai" class="md-nav__link">
    <span class="md-ellipsis">
      ONNX Runtime for GENAI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-onnx-runtime" class="md-nav__link">
    <span class="md-ellipsis">
      Install ONNX Runtime:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-generative-ai-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      Install the Generative AI Extensions:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-a-model-heres-a-simple-example-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Run a Model: Here’s a simple example in Python:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demousing-onnx-runtime-genai-to-call-phi-35-vision" class="md-nav__link">
    <span class="md-ellipsis">
      Demo:Using ONNX Runtime GenAI to call Phi-3.5-Vision
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more" class="md-nav__link">
    <span class="md-ellipsis">
      More
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20-mistral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    20. Mistral
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21-meta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    21. Meta
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-small-language-models" class="md-nav__link">
    <span class="md-ellipsis">
      What Are Small Language Models?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-small-language-models-work" class="md-nav__link">
    <span class="md-ellipsis">
      How Do Small Language Models Work?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-distinctions-between-large-language-models-llms-and-small-language-models-slms" class="md-nav__link">
    <span class="md-ellipsis">
      The Distinctions between Large Language Models (LLMs) and Small Language Models (SLMs)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#applications-of-small-language-models" class="md-nav__link">
    <span class="md-ellipsis">
      Applications of Small Language Models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduce-phi-3-phi-35-family" class="md-nav__link">
    <span class="md-ellipsis">
      Introduce Phi-3 / Phi-3.5 Family
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduce Phi-3 / Phi-3.5 Family">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phi-3-35-instruct" class="md-nav__link">
    <span class="md-ellipsis">
      Phi-3 / 3.5 Instruct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phi-3-35-vision" class="md-nav__link">
    <span class="md-ellipsis">
      Phi-3 / 3.5 Vision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phi-35-moe" class="md-nav__link">
    <span class="md-ellipsis">
      Phi-3.5-MoE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-phi-335-family-models" class="md-nav__link">
    <span class="md-ellipsis">
      How to use Phi-3/3.5 Family models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to use Phi-3/3.5 Family models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inference-difference-clouds-api" class="md-nav__link">
    <span class="md-ellipsis">
      Inference difference Cloud's API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inference-phi-335-in-local-env" class="md-nav__link">
    <span class="md-ellipsis">
      Inference Phi-3/3.5 in local env
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-onnx-runtime" class="md-nav__link">
    <span class="md-ellipsis">
      What is ONNX Runtime?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-generative-ai" class="md-nav__link">
    <span class="md-ellipsis">
      What is Generative AI?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onnx-runtime-for-genai" class="md-nav__link">
    <span class="md-ellipsis">
      ONNX Runtime for GENAI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-onnx-runtime" class="md-nav__link">
    <span class="md-ellipsis">
      Install ONNX Runtime:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-generative-ai-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      Install the Generative AI Extensions:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-a-model-heres-a-simple-example-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Run a Model: Here’s a simple example in Python:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demousing-onnx-runtime-genai-to-call-phi-35-vision" class="md-nav__link">
    <span class="md-ellipsis">
      Demo:Using ONNX Runtime GenAI to call Phi-3.5-Vision
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more" class="md-nav__link">
    <span class="md-ellipsis">
      More
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="introduction-to-small-language-models-for-generative-ai-for-beginners">Introduction to Small Language Models for Generative AI for Beginners<a class="headerlink" href="#introduction-to-small-language-models-for-generative-ai-for-beginners" title="Permanent link">&para;</a></h1>
<p>Generative AI is a fascinating field of artificial intelligence that focuses on creating systems capable of generating new content. This content can range from text and images to music and even entire virtual environments. One of the most exciting applications of generative AI is in the realm of language models.</p>
<h2 id="what-are-small-language-models">What Are Small Language Models?<a class="headerlink" href="#what-are-small-language-models" title="Permanent link">&para;</a></h2>
<p>A Small Language Model (SLM) represents a scaled-down variant of a large language model (LLM), leveraging many of the architectural principles and techniques of LLMs, while exhibiting a significantly reduced computational footprint. </p>
<p>SLMs are a subset of language models designed to generate human-like text. Unlike their larger counterparts, such as GPT-4, SLMs are more compact and efficient, making them ideal for applications where computational resources are limited. Despite their smaller size, they can still perform a variety of tasks. Typically, SLMs are constructed by compressing or distilling LLMs, aiming to retain a substantial portion of the original model's functionality and linguistic capabilities. This reduction in model size decreases the overall complexity, making SLMs more efficient in terms of both memory usage and computational requirements. Despite these optimizations, SLMs can still perform a wide range of natural language processing (NLP) tasks:</p>
<ul>
<li>Text Generation: Creating coherent and contextually relevant sentences or paragraphs.</li>
<li>Text Completion: Predicting and completing sentences based on a given prompt.</li>
<li>Translation: Converting text from one language to another.</li>
<li>Summarization: Condensing long pieces of text into shorter, more digestible summaries.</li>
</ul>
<p>Albeit with some trade-offs in performance or depth of understanding compared to their larger counterparts. </p>
<h2 id="how-do-small-language-models-work">How Do Small Language Models Work?<a class="headerlink" href="#how-do-small-language-models-work" title="Permanent link">&para;</a></h2>
<p>SLMs are trained on vast amounts of text data. During training, they learn the patterns and structures of language, enabling them to generate text that is both grammatically correct and contextually appropriate. The training process involves:</p>
<ul>
<li>Data Collection: Gathering large datasets of text from various sources.</li>
<li>Preprocessing: Cleaning and organizing the data to make it suitable for training.</li>
<li>Training: Using machine learning algorithms to teach the model how to understand and generate text.</li>
<li>Fine-Tuning: Adjusting the model to improve its performance on specific tasks.</li>
</ul>
<p>The development of SLMs aligns with the increasing need for models that can be deployed in resource-constrained environments, such as mobile devices or edge computing platforms, where full-scale LLMs may be impractical due to their heavy resource demands. By focusing on efficiency, SLMs balance performance with accessibility, enabling broader application across various domains.</p>
<p><img alt="slm" src="img/slm.png?WT.mc_id=academic-105485-koreyst" /></p>
<h2 id="learning-objectives">Learning Objectives<a class="headerlink" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>In this lesson, we hope to introduce the knowledge of SLM and combine it with Microsoft Phi-3 to learn different scenarios in text content, vision and MoE.</p>
<p>By the end of this lesson, you should be able to answer the following questions:</p>
<ul>
<li>What is SLM</li>
<li>What is the difference about SLM and LLM</li>
<li>What is Microsoft Phi-3/3.5 Family</li>
<li>How to inference Microsoft Phi-3/3.5 Family</li>
</ul>
<p>Ready? Let's get started.</p>
<h2 id="the-distinctions-between-large-language-models-llms-and-small-language-models-slms">The Distinctions between Large Language Models (LLMs) and Small Language Models (SLMs)<a class="headerlink" href="#the-distinctions-between-large-language-models-llms-and-small-language-models-slms" title="Permanent link">&para;</a></h2>
<p>Both LLMs and SLMs are built upon foundational principles of probabilistic machine learning, following similar approaches in their architectural design, training methodologies, data generation processes, and model evaluation techniques. However, several key factors differentiate these two types of models.</p>
<h2 id="applications-of-small-language-models">Applications of Small Language Models<a class="headerlink" href="#applications-of-small-language-models" title="Permanent link">&para;</a></h2>
<p>SLMs have a wide range of applications, including:</p>
<ul>
<li>Chatbots: Providing customer support and engaging with users in a conversational manner.</li>
<li>Content Creation: Assisting writers by generating ideas or even drafting entire articles.</li>
<li>Education: Helping students with writing assignments or learning new languages.</li>
<li>Accessibility: Creating tools for individuals with disabilities, such as text-to-speech systems.</li>
</ul>
<p><strong>Size</strong></p>
<p>A primary distinction between LLMs and SLMs lies in the scale of the models. LLMs, such as ChatGPT (GPT-4), can comprise an estimated 1.76 trillion parameters, while open-source SLMs like Mistral 7B are designed with significantly fewer parameters—approximately 7 billion. This disparity is primarily due to differences in model architecture and training processes. For instance, ChatGPT employs a self-attention mechanism within an encoder-decoder framework, whereas Mistral 7B uses sliding window attention, which enables more efficient training within a decoder-only model. This architectural variance has profound implications for the complexity and performance of these models.</p>
<p><strong>Comprehension</strong></p>
<p>SLMs are typically optimized for performance within specific domains, making them highly specialized but potentially limited in their ability to provide broad contextual understanding across multiple fields of knowledge. In contrast, LLMs aim to simulate human-like intelligence on a more comprehensive level. Trained on vast, diverse datasets, LLMs are designed to perform well across a variety of domains, offering greater versatility and adaptability. Consequently, LLMs are more suitable for a wider range of downstream tasks, such as natural language processing and programming.</p>
<p><strong>Computing</strong></p>
<p>The training and deployment of LLMs are resource-intensive processes, often requiring significant computational infrastructure, including large-scale GPU clusters. For example, training a model like ChatGPT from scratch may necessitate thousands of GPUs over extended periods. In contrast, SLMs, with their smaller parameter counts, are more accessible in terms of computational resources. Models like Mistral 7B can be trained and run on local machines equipped with moderate GPU capabilities, although training still demands several hours across multiple GPUs.</p>
<p><strong>Bias</strong></p>
<p>Bias is a known issue in LLMs, primarily due to the nature of the training data. These models often rely on raw, openly available data from the internet, which may underrepresent or misrepresent certain groups, introduce erroneous labeling, or reflect linguistic biases influenced by dialect, geographic variations, and grammatical rules. Additionally, the complexity of LLM architectures can inadvertently exacerbate bias, which may go unnoticed without careful fine-tuning. On the other hand, SLMs, being trained on more constrained, domain-specific datasets, are inherently less susceptible to such biases, though they are not immune to them.</p>
<p><strong>Inference</strong></p>
<p>The reduced size of SLMs affords them a significant advantage in terms of inference speed, allowing them to generate outputs efficiently on local hardware without the need for extensive parallel processing. In contrast, LLMs, due to their size and complexity, often require substantial parallel computational resources to achieve acceptable inference times. The presence of multiple concurrent users further slows down LLMs' response times, especially when deployed at scale.</p>
<p>In summary, while both LLMs and SLMs share a foundational basis in machine learning, they differ significantly in terms of model size, resource requirements, contextual understanding, susceptibility to bias, and inference speed. These distinctions reflect their respective suitability for different use cases, with LLMs being more versatile but resource-heavy, and SLMs offering more domain-specific efficiency with reduced computational demands.</p>
<p><strong><em>Note：In this chapter, we will introduce SLM using Microsoft Phi-3 / 3.5 as an example.</em></strong></p>
<h2 id="introduce-phi-3-phi-35-family">Introduce Phi-3 / Phi-3.5 Family<a class="headerlink" href="#introduce-phi-3-phi-35-family" title="Permanent link">&para;</a></h2>
<p>Phi-3 / 3.5 Family mainly targets text, vision, and Agent (MoE) application scenarios:</p>
<h3 id="phi-3-35-instruct">Phi-3 / 3.5 Instruct<a class="headerlink" href="#phi-3-35-instruct" title="Permanent link">&para;</a></h3>
<p>Mainly for text generation, chat completion, and content information extraction, etc.</p>
<p><strong>Phi-3-mini</strong></p>
<p>The 3.8B language model is available on Microsoft Azure AI Studio, Hugging Face, and Ollama. Phi-3 models significantly outperform language models of equal and larger sizes on key benchmarks (see benchmark numbers below, higher numbers are better). Phi-3-mini outperforms models twice its size, while Phi-3-small and Phi-3-medium outperform larger models, including GPT-3.5</p>
<p><strong>Phi-3-small &amp; medium</strong></p>
<p>With just 7B parameters, Phi-3-small beats GPT-3.5T on a variety of language, reasoning, coding, and math benchmarks.</p>
<p>The Phi-3-medium with 14B parameters continues this trend and outperforms the Gemini 1.0 Pro.</p>
<p><strong>Phi-3.5-mini</strong></p>
<p>We can think of it as an upgrade of Phi-3-mini. While the parameters remain unchanged, it improves the ability to support multiple languages(
Support 20+ languages:Arabic, Chinese, Czech, Danish, Dutch, English, Finnish, French, German, Hebrew, Hungarian, Italian, Japanese, Korean, Norwegian, Polish, Portuguese, Russian, Spanish, Swedish, Thai, Turkish, Ukrainian) ​​and adds stronger support for long context.</p>
<p>Phi-3.5-mini with 3.8B parameters outperforms language models of the same size and on par with models twice its size.</p>
<h3 id="phi-3-35-vision">Phi-3 / 3.5 Vision<a class="headerlink" href="#phi-3-35-vision" title="Permanent link">&para;</a></h3>
<p>We can think of the Instruct model of Phi-3/3.5 as Phi's ability to understand, and Vision is what gives Phi eyes to understand the world.</p>
<p><strong>Phi-3-Vision</strong></p>
<p>Phi-3-vision, with only 4.2B parameters, continues this trend and outperforms larger models such as Claude-3 Haiku and Gemini 1.0 Pro V on general visual reasoning tasks, OCR, and table and diagram comprehension tasks.</p>
<p><strong>Phi-3.5-Vision</strong></p>
<p>Phi-3.5-Vision is also an upgrade of Phi-3-Vision, adding support for multiple images. You can think of it as an improvement in vision, not only can you see pictures, but also videos.</p>
<p>Phi-3.5-vision outperforms larger models such as Claude-3.5 Sonnet and Gemini 1.5 Flash across OCR, table and chart understanding tasks and on par on general visual knowledge reasoning tasks.Support multi-frame input, i.e., perform reasoning on multiple input images</p>
<h3 id="phi-35-moe">Phi-3.5-MoE<a class="headerlink" href="#phi-35-moe" title="Permanent link">&para;</a></h3>
<p><strong><em>Mixture of Experts(MoE)</em></strong> enable models to be pretrained with far less compute, which means you can dramatically scale up the model or dataset size with the same compute budget as a dense model. In particular, a MoE model should achieve the same quality as its dense counterpart much faster during pretraining.</p>
<p>Phi-3.5-MoE comprises 16x3.8B expert modules.Phi-3.5-MoE with only 6.6B active parameters achieves a similar level of reasoning, language understanding, and math as much larger models</p>
<p>We can use the Phi-3/3.5 Family model based on different scenarios. Unlike LLM, you can deploy Phi-3/3.5-mini or Phi-3/3.5-Vision on edge devices.</p>
<h2 id="how-to-use-phi-335-family-models">How to use Phi-3/3.5 Family models<a class="headerlink" href="#how-to-use-phi-335-family-models" title="Permanent link">&para;</a></h2>
<p>We hope to use Phi-3/3.5 in different scenarios. Next, we will use Phi-3/3.5 based on different scenarios.</p>
<p><img alt="phi3" src="img/phi3.png?WT.mc_id=academic-105485-koreyst" /></p>
<h3 id="inference-difference-clouds-api">Inference difference Cloud's API<a class="headerlink" href="#inference-difference-clouds-api" title="Permanent link">&para;</a></h3>
<p><strong>GitHub Models</strong></p>
<p>GitHub Models is the most direct way. You can quickly access the Phi-3/3.5-Instruct model through GitHub Models. Combined with the Azure AI Inference SDK / OpenAI SDK, you can access the API through code to complete the Phi-3/3.5-Instruct call. You can also test different effects through Playground.</p>
<ul>
<li>Demo:Comparison of the effects of Phi-3-mini and Phi-3.5-mini in Chinese scenarios</li>
</ul>
<p><img alt="phi3" src="img/gh1.png?WT.mc_id=academic-105485-koreyst" /></p>
<p><img alt="phi35" src="img/gh2.png?WT.mc_id=academic-105485-koreyst" /></p>
<p><strong>Azure AI Studio</strong></p>
<p>Or if we want to use the vision and MoE models, you can use Azure AI Studio to complete the call. If you are interested, you can read the Phi-3 Cookbook to learn how to call Phi-3/3.5 Instruct, Vision, MoE through Azure AI Studio <a href="https://github.com/microsoft/Phi-3CookBook/blob/main/md/02.QuickStart/AzureAIStudio_QuickStart.md?WT.mc_id=academic-105485-koreyst">Click this link</a></p>
<p><strong>NVIDIA NIM</strong></p>
<p>In addition to the cloud-based Model Catalog solutions provided by Azure and GitHub, you can also use <a href="https://developer.nvidia.com/nim?WT.mc_id=academic-105485-koreyst">Nivida NIM</a> to complete related calls. You can visit NIVIDA NIM to complete the API calls of Phi-3/3.5 Family. NVIDIA NIM (NVIDIA Inference Microservices) is a set of accelerated inference microservices designed to help developers deploy AI models efficiently across various environments, including clouds, data centers, and workstations.</p>
<p>Here are some key features of NVIDIA NIM:</p>
<ul>
<li><strong>Ease of Deployment:</strong> NIM allows for the deployment of AI models with a single command, making it straightforward to integrate into existing workflows.</li>
<li><strong>Optimized Performance:</strong> It leverages NVIDIA’s pre-optimized inference engines, such as TensorRT and TensorRT-LLM, to ensure low latency and high throughput.</li>
<li><strong>Scalability:</strong> NIM supports autoscaling on Kubernetes, enabling it to handle varying workloads effectively.</li>
<li><strong>Security and Control:</strong> Organizations can maintain control over their data and applications by self-hosting NIM microservices on their own managed infrastructure.</li>
<li><strong>Standard APIs:</strong> NIM provides industry-standard APIs, making it easy to build and integrate AI applications like chatbots, AI assistants, and more.</li>
</ul>
<p>NIM is part of NVIDIA AI Enterprise, which aims to simplify the deployment and operationalization of AI models, ensuring they run efficiently on NVIDIA GPUs.</p>
<ul>
<li>Demo: Using Nividia NIM to call Phi-3.5-Vision-API  [<a href="python/Phi-3-Vision-Nividia-NIM.ipynb?WT.mc_id=academic-105485-koreyst">Click this link</a>]</li>
</ul>
<h3 id="inference-phi-335-in-local-env">Inference Phi-3/3.5 in local env<a class="headerlink" href="#inference-phi-335-in-local-env" title="Permanent link">&para;</a></h3>
<p>Inference in relation to Phi-3, or any language model like GPT-3, refers to the process of generating responses or predictions based on the input it receives. When you provide a prompt or question to Phi-3, it uses its trained neural network to infer the most likely and relevant response by analyzing patterns and relationships in the data it was trained on.</p>
<p><strong>Hugging face Transformer</strong>
Hugging Face Transformers is a powerful library designed for natural language processing (NLP) and other machine learning tasks. Here are some key points about it:</p>
<ol>
<li>
<p><strong>Pretrained Models</strong>: It provides thousands of pretrained models that can be used for various tasks such as text classification, named entity recognition, question answering, summarization, translation, and text generation.</p>
</li>
<li>
<p><strong>Framework Interoperability</strong>: The library supports multiple deep learning frameworks, including PyTorch, TensorFlow, and JAX. This allows you to train a model in one framework and use it in another.</p>
</li>
<li>
<p><strong>Multimodal Capabilities</strong>: Besides NLP, Hugging Face Transformers also supports tasks in computer vision (e.g., image classification, object detection) and audio processing (e.g., speech recognition, audio classification).</p>
</li>
<li>
<p><strong>Ease of Use</strong>: The library offers APIs and tools to easily download and fine-tune models, making it accessible for both beginners and experts.</p>
</li>
<li>
<p><strong>Community and Resources</strong>: Hugging Face has a vibrant community and extensive documentation, tutorials, and guides to help users get started and make the most of the library.
<a href="https://huggingface.co/docs/transformers/index?WT.mc_id=academic-105485-koreyst">official documentation</a> or their <a href="https://github.com/huggingface/transformers?WT.mc_id=academic-105485-koreyst">GitHub repository</a>.</p>
</li>
</ol>
<p>This is the most commonly used method, but it also requires GPU acceleration. After all, scenes such as Vision and MoE require a lot of calculations, which will be very limited in the CPU if they are not quantized.</p>
<ul>
<li>
<p>Demo:Using Transformer to call Phi-3.5-Instuct <a href="python/phi35-instruct-demo.ipynb?WT.mc_id=academic-105485-koreyst">Click this link</a></p>
</li>
<li>
<p>Demo:Using Transformer to call Phi-3.5-Vision<a href="python/phi35-vision-demo.ipynb?WT.mc_id=academic-105485-koreyst">Click this link</a></p>
</li>
<li>
<p>Demo:Using Transformer to call Phi-3.5-MoE<a href="python/phi35_moe_demo.ipynb?WT.mc_id=academic-105485-koreyst">Click this link</a></p>
</li>
</ul>
<p><strong>Ollama</strong>
<a href="https://ollama.com/?WT.mc_id=academic-105485-koreyst">Ollama</a> is a platform designed to make it easier to run large language models (LLMs) locally on your machine. It supports various models like Llama 3.1, Phi 3, Mistral, and Gemma 2, among others. The platform simplifies the process by bundling model weights, configuration, and data into a single package, making it more accessible for users to customize and create their own models. Ollama is available for macOS, Linux, and Windows. It’s a great tool if you’re looking to experiment with or deploy LLMs without relying on cloud services. Ollama is the most direct way, you just need to execute the following statement.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ollama<span class="w"> </span>run<span class="w"> </span>phi3.5
</code></pre></div></td></tr></table></div>
<p><strong>ONNX Runtime for GenAI</strong></p>
<p><a href="https://github.com/microsoft/onnxruntime-genai?WT.mc_id=academic-105485-koreyst">ONNX Runtime</a> is a cross-platform inference and training machine-learning accelerator. ONNX Runtime for Generative AI (GENAI) is a powerful tool that helps you run generative AI models efficiently across various platforms. </p>
<h2 id="what-is-onnx-runtime">What is ONNX Runtime?<a class="headerlink" href="#what-is-onnx-runtime" title="Permanent link">&para;</a></h2>
<p>ONNX Runtime is an open-source project that enables high-performance inference of machine learning models. It supports models in the Open Neural Network Exchange (ONNX) format, which is a standard for representing machine learning models.ONNX Runtime inference can enable faster customer experiences and lower costs, supporting models from deep learning frameworks such as PyTorch and TensorFlow/Keras as well as classical machine learning libraries such as scikit-learn, LightGBM, XGBoost, etc. ONNX Runtime is compatible with different hardware, drivers, and operating systems, and provides optimal performance by leveraging hardware accelerators where applicable alongside graph optimizations and transforms</p>
<h2 id="what-is-generative-ai">What is Generative AI?<a class="headerlink" href="#what-is-generative-ai" title="Permanent link">&para;</a></h2>
<p>Generative AI refers to AI systems that can generate new content, such as text, images, or music, based on the data they have been trained on. Examples include language models like GPT-3 and image generation models like Stable Diffusion. ONNX Runtime for GenAI library provides the generative AI loop for ONNX models, including inference with ONNX Runtime, logits processing, search and sampling, and KV cache management.</p>
<h2 id="onnx-runtime-for-genai">ONNX Runtime for GENAI<a class="headerlink" href="#onnx-runtime-for-genai" title="Permanent link">&para;</a></h2>
<p>ONNX Runtime for GENAI extends the capabilities of ONNX Runtime to support generative AI models. Here are some key features:</p>
<ul>
<li><strong>Broad Platform Support:</strong> It works on various platforms, including Windows, Linux, macOS, Android, and iOS.</li>
<li><strong>Model Support:</strong> It supports many popular generative AI models, such as LLaMA, GPT-Neo, BLOOM, and more.</li>
<li><strong>Performance Optimization:</strong> It includes optimizations for different hardware accelerators like NVIDIA GPUs, AMD GPUs, and more2.</li>
<li><strong>Ease of Use:</strong> It provides APIs for easy integration into applications, allowing you to generate text, images, and other content with minimal code</li>
<li>Users can call a high level generate() method, or run each iteration of the model in a loop, generating one token at a time, and optionally updating generation parameters inside the loop.</li>
<li>ONNX runtume also has support for greedy/beam search and TopP, TopK sampling to generate token sequences and built-in logits processing like repetition penalties. You can also easily add custom scoring.</li>
</ul>
<h2 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<p>To get started with ONNX Runtime for GENAI, you can follow these steps:</p>
<h3 id="install-onnx-runtime">Install ONNX Runtime:<a class="headerlink" href="#install-onnx-runtime" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">pip</span> <span class="n">install</span> <span class="n">onnxruntime</span>
</code></pre></div></td></tr></table></div>
<h3 id="install-the-generative-ai-extensions">Install the Generative AI Extensions:<a class="headerlink" href="#install-the-generative-ai-extensions" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">pip</span> <span class="n">install</span> <span class="n">onnxruntime</span><span class="o">-</span><span class="n">genai</span>
</code></pre></div></td></tr></table></div>
<h3 id="run-a-model-heres-a-simple-example-in-python">Run a Model: Here’s a simple example in Python:<a class="headerlink" href="#run-a-model-heres-a-simple-example-in-python" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">onnxruntime_genai</span> <span class="k">as</span> <span class="nn">og</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;path_to_your_model.onnx&#39;</span><span class="p">)</span>

<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Tokenizer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">input_text</span> <span class="o">=</span> <span class="s2">&quot;Hello, how are you?&quot;</span>

<span class="n">input_tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span>

<span class="n">output_tokens</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">input_tokens</span><span class="p">)</span>

<span class="n">output_text</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">output_tokens</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">output_text</span><span class="p">)</span> 
</code></pre></div></td></tr></table></div>
<h3 id="demousing-onnx-runtime-genai-to-call-phi-35-vision">Demo:Using ONNX Runtime GenAI to call Phi-3.5-Vision<a class="headerlink" href="#demousing-onnx-runtime-genai-to-call-phi-35-vision" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">onnxruntime_genai</span> <span class="k">as</span> <span class="nn">og</span>

<span class="n">model_path</span> <span class="o">=</span> <span class="s1">&#39;./Your Phi-3.5-vision-instruct ONNX Path&#39;</span>

<span class="n">img_path</span> <span class="o">=</span> <span class="s1">&#39;./Your Image Path&#39;</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

<span class="n">processor</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_multimodal_processor</span><span class="p">()</span>

<span class="n">tokenizer_stream</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">create_stream</span><span class="p">()</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Your Prompt&quot;</span>

<span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&lt;|user|&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="n">prompt</span> <span class="o">+=</span> <span class="s2">&quot;&lt;|image_1|&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="n">prompt</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&lt;|end|&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="n">prompt</span> <span class="o">+=</span> <span class="s2">&quot;&lt;|assistant|&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Images</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">processor</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">images</span><span class="o">=</span><span class="n">image</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">GeneratorParams</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">params</span><span class="o">.</span><span class="n">set_inputs</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

<span class="n">params</span><span class="o">.</span><span class="n">set_search_options</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3072</span><span class="p">)</span>

<span class="n">generator</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

<span class="k">while</span> <span class="ow">not</span> <span class="n">generator</span><span class="o">.</span><span class="n">is_done</span><span class="p">():</span>

    <span class="n">generator</span><span class="o">.</span><span class="n">compute_logits</span><span class="p">()</span>

    <span class="n">generator</span><span class="o">.</span><span class="n">generate_next_token</span><span class="p">()</span>

    <span class="n">new_token</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">get_next_tokens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">code</span> <span class="o">+=</span> <span class="n">tokenizer_stream</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">new_token</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">tokenizer_stream</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">new_token</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Others</strong></p>
<p>In addition to ONNX Runtime and Ollama reference methods, we can also complete the reference of quantitative models based on the model reference methods provided by different manufacturers. Such as Apple MLX framework with Apple Metal, Qualcomm QNN with NPU, Intel OpenVINO with CPU/GPU, etc. You can also get more content from <a href="https://github.com/microsoft/phi-3cookbook?WT.mc_id=academic-105485-koreyst">Phi-3 Cookbook</a></p>
<h2 id="more">More<a class="headerlink" href="#more" title="Permanent link">&para;</a></h2>
<p>We have learned the basics of Phi-3/3.5 Family, but to learn more about SLM we need more knowledge. You can find the answers in the Phi-3 Cookbook. If you want to learn more, please visit the <a href="https://github.com/microsoft/phi-3cookbook?WT.mc_id=academic-105485-koreyst">Phi-3 Cookbook</a>.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../18-fine-tuning/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 18. Fine Tuning">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                18. Fine Tuning
              </div>
            </div>
          </a>
        
        
          
          <a href="../20-mistral/" class="md-footer__link md-footer__link--next" aria-label="Next: 20. Mistral">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                20. Mistral
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 - present Microsoft

    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.expand", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "navigation.top", "toc.follow", "navigation.footer", "content.code.copy", "content.tabs.link"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>